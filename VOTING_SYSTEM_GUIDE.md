# 社区投票系统使用指南

基于PRD.md构建的区块链投票系统，解决传统投票流程中的用户痛点。

## 系统特点

### 解决的痛点
1. **公示变更内容友好** - 提供用户友好的diff变更说明，降低阅读成本
2. **内容一致性保证** - 区块链保证投票内容不可篡改
3. **成本大幅降低** - 无需三方会务公司，节省每户20元费用
4. **自动化通知** - 替代人工电话通知，提高效率
5. **数据透明可查** - 所有投票数据公开透明，无法篡改
6. **便捷错误追溯** - 区块链记录可追溯，降低倒查成本

### 投票选项
- **同意** - 支持该提案
- **反对** - 反对该提案  
- **弃权** - 不参与表决
- **随多数** - 跟随多数结果

## 功能页面

### 1. 首页 (`/`)
- 系统介绍和导航
- 连接钱包功能
- 快速进入各功能模块

### 2. 创建提案 (`/create-proposal`)
**使用者：** 业委会成员

**功能：**
- 填写提案标题和内容
- 添加用户友好的变更说明（解决PRD痛点1）
- 设置投票持续时间
- 配置投票白名单（一个case对应一个白名单校验）

**权限控制：**
- 只有业委会成员可以创建提案
- 系统自动校验创建者权限

### 3. 参与投票 (`/vote`)
**使用者：** 白名单用户

**功能：**
- 查看活跃提案列表
- 查看提案详情和变更说明
- 选择投票选项（同意/反对/弃权/随多数）
- 添加投票建议（可选）

**权限控制：**
- 只有在提案白名单中的用户可以投票
- 每个用户每个提案只能投票一次
- 只能在投票期间内投票

### 4. 投票统计 (`/results`)
**使用者：** 所有用户

**功能：**
- 查看所有提案的投票结果
- 投票数据可视化统计图表
- 透明的投票者明细（解决PRD痛点5）
- 实时投票进度展示

**数据透明：**
- 所有投票数据公开可查
- 投票者地址和选择完全透明
- 无法篡改的区块链记录

## 技术架构

### 前端
- **Next.js 14** - 现代化的React框架
- **TailwindCSS + DaisyUI** - 响应式UI设计
- **RainbowKit + Wagmi** - Web3钱包连接
- **TypeScript** - 类型安全

### 智能合约
- **Solidity** - 以太坊智能合约
- **OpenZeppelin** - 安全的合约库
- **Foundry** - 合约开发框架

### 核心合约功能
```solidity
// 创建提案
function createProposal(title, content, diffContent, duration, whitelist)

// 参与投票
function vote(proposalId, option, comment)

// 查询功能
function getProposal(proposalId)
function getProposalVoteStats(proposalId)
function isWhitelisted(proposalId, user)
```

## 开发和部署

### 本地开发
```bash
# 启动本地区块链
yarn chain

# 部署合约
yarn deploy

# 启动前端
yarn start
```

### 访问地址
- 前端：http://localhost:3000
- 区块链浏览器：http://localhost:3000/blockexplorer
- 合约调试：http://localhost:3000/debug

## 用户流程

### 业委会创建提案
1. 连接钱包
2. 访问"创建提案"页面
3. 填写提案信息和变更说明
4. 配置投票白名单
5. 设置投票持续时间
6. 提交创建提案交易

### 用户参与投票
1. 连接钱包
2. 访问"参与投票"页面
3. 选择要投票的提案
4. 查看提案详情和变更说明
5. 选择投票选项
6. 可选填写投票建议
7. 提交投票交易

### 查看统计结果
1. 访问"投票统计"页面
2. 选择查看的提案
3. 查看投票分布图表
4. 查看透明的投票者明细
5. 分析投票趋势和数据

## 成本分析

### 传统流程成本（以PRD为例）
- 三方会务公司：每户20元
- 杭州单个一线城市：数百万次 × 20元 = 数千万元/年

### 区块链方案成本
- Gas费用：约0.001-0.01 ETH per transaction
- 无需三方会务公司
- **成本降低95%以上**

## 安全特性

1. **权限控制** - 多层权限验证
2. **防重复投票** - 合约层面防止重复投票
3. **时间限制** - 投票时间窗口控制
4. **数据不可篡改** - 区块链特性保证
5. **透明可审计** - 所有操作公开记录

## 扩展性

系统设计支持：
- 多种投票模式
- 复杂权重投票
- 多轮投票
- 投票委托
- AI内容生成和解读

---

*本系统完全基于PRD.md需求构建，专注解决传统投票流程中的实际痛点。*